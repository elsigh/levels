<!DOCTYPE html>
  <html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="format-detection" content="telephone=no,email=no,address=no">
    <meta name="viewport"
      content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height">

    <!-- target-densitydpi=device-dpi -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/account.css">
    <link rel="stylesheet" href="css/following.css">
    <link rel="stylesheet" href="css/rickshaw.css">

    <title>Level</title>
    <!--<script src="http://localhost:8090/target/target-script-min.js#anonymous"></script>-->
  </head>
  <body>
    <div class="fmb-app">
      <h1>Level</h1>
      <section class="tabs">
        <a href="following" class="following">Following</a><a
          href="account" class="account">Account</a><span
          class="share">Share!</share>
      </section>
      <section class="fmb-tab fmb-tab-account">
        <div class="fmb-account"></div>
      </section>
      <section class="fmb-tab fmb-tab-following">
        <div class="fmb-following"></div>
      </section>
    </div>

    <script src="js/cordova-2.5.0.js"></script>
    <script src="js/phonediedservice_plugin.js"></script>
    <script src="js/webintent.js"></script>
    <script src="js/ContactView.js"></script>
    <script src="js/zepto-1.0rc1.js"></script>
    <script src="js/touch.js"></script>
    <script src="js/underscore-1.4.4.js"></script>
    <script src="js/backbone-1.0.js"></script>
    <script src="js/backbone.localStorage.js"></script>
    <script src="js/hogan-2.0.0.js"></script>
    <script src="js/app.js"></script>
    <script src="js/models_fmb.js"></script>
    <script src="js/models.js"></script>
    <script src="js/views.js"></script>

    <script src="js/d3.v2.js"></script>
    <script src="js/rickshaw.js"></script>

    <script id="tpl_account" type="text/html">
      {{^user.api_token}}
        <h2>Welcome to the App!</h2>
        <p>
          Send family and friends a notification *before* your battery dies!
        </p>
        <p>
          To get started:
        </p>
        <div class="login-google"><span>Sign in with Google</span></div>
      {{/user.api_token}}

      {{#user.api_token}}
        <div class="user-img-name">
          <img src="{{user.avatar_url}}" width="100" alt="">
          <h2>{{user.name}}</h2>
        </div>
      {{/user.api_token}}
    </script>

    <script id="tpl_device" type="text/html">
      <form method="post"
        class="device-update"
        action="{{api_server}}/api/device">
        <h3>
          {{platform}}
          {{name}}
        </h3>
      </form>
    </script>

    <script id="tpl_notifying" type="text/html">
      <p>
        Sends a notification when your battery hits 10%
      </p>

      <button class="notifying-add-phone">+ by phone</button>
      <button class="notifying-add-email">+ by email</button>

      <table>
        <thead>
          <tr>
            <th>name</th>
            <th>contact</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {{#notifying.length}}
            {{#notifying}}
              <tr>
                <td>
                  <span class="notifying-name">{{name}}</span>
                </td>
                <td>
                  {{means}}
                </td>
                <td class="remove-cell">
                  <div class="remove" data-means="{{means}}">X</div>
                </td>
              </tr>
            {{/notifying}}
          {{/notifying.length}}

          {{^notifying.length}}
            <tr>
              <td colspan="3">
                Show them you care, add somebody you love.
              </td>
            </tr>
          {{/notifying.length}}

        </tbody>
      </table>
    </script>


    <script id="tpl_following" type="text/html">
      <h2>Following</h2>
      <button class="share">+ someone</button>
      <table>
        <thead>
          <tr>
            <th>name</th>
            <th>battery</th>
            <th>device</th>
            <th></th>
          </tr>
        </thead>
        <tbody>

          {{#following}}
            <tr>
              <td colspan="3">{{name}}</td>
              <td class="remove-cell">
                <div class="remove" data-userkey="{{key}}">X</div>
              </td>
            </tr>
            {{#devices}}
              <tr>
                <td>
                </td>
                <td class="battery-level-c charging-{{settings.0.is_charging}}">
                  <div class="battery-level"
                    style="background-image:-webkit-gradient(linear, left top, right top, color-stop({{settings.0.battery_level}}%, green), color-stop({{settings.0.battery_level}}%, white))">
                    {{settings.0.battery_level}}%
                  </div>
                  <div class="battery-created">
                    {{settings.0.created}}
                  </div>
                </td>
                <td>{{platform}} {{name}}</td>
                <td></td>
              </tr>
            {{/devices}}
          {{/following}}
        </tbody>
        <tfoot>
          <tr>
            <td colspan="5">
              Follow more batteries!
            </td>
          </tr>
        </tfoot>
      </table>
    </script>


    <script>
      window.onerror = function(message, url, lineNumber) {
        console.log('window.onerror GLOBAL FAIL: ' + message + ', ' +
                    url + ', ' + lineNumber);
      };
      window.templates = {};
      _.each(['account', 'device', 'following', 'notifying'], function(name) {
        var html = $('#tpl_' + name).html().trim();
        window.templates[name] = Hogan.compile(html);
      });

      document.addEventListener('deviceready', function() {
        window['app'] = new fmb.App();
      }, false);

    </script>
  </body>
  </html>
